<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Lilyfy – Minhas Músicas e Playlists</title>
  <style>
    :root {
      --roxo: #8a2be2;
      --cinza: #181818;
      --cinza-claro: #b3b3b3;
      --preto: #121212;
      --branco: #ffffff;
      --card-bg: #1e1e1e;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background-color: var(--preto);
      color: var(--branco);
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: var(--card-bg);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .logo { font-size: 24px; color: var(--roxo); font-weight: bold; }
    nav button {
      background: none;
      border: none;
      color: var(--cinza-claro);
      margin-right: 16px;
      font-size: 16px;
      cursor: pointer;
    }
    nav button.active { color: var(--roxo); font-weight: bold; }
    .container { flex: 1; padding: 20px; }
    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px,1fr)); gap: 20px; }
    .card { background: var(--card-bg); border-radius: 8px; overflow: hidden; cursor: pointer; }
    .card img { width: 100%; display: block; }
    .info { padding: 10px; }
    .info h3 { margin: 0 0 6px; font-size: 16px; }
    .info p { margin: 0; font-size: 14px; color: var(--cinza-claro); }
    #playlistContainer .playlist-item {
      padding: 8px;
      border-bottom: 1px solid #333;
      cursor: pointer;
    }
    #playlistContainer .playlist-item:hover { background: #222; }
    .player {
      background: var(--card-bg);
      padding: 10px 20px;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }
    .player-info { display: flex; align-items: center; gap: 12px; }
    .player-cover { width: 50px; height: 50px; object-fit: cover; border-radius: 4px; }
    audio { width: 100%; }
    .controls button {
      background: none;
      border: none;
      color: var(--cinza-claro);
      font-size: 20px;
      margin: 0 8px;
      cursor: pointer;
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">LILYFY</div>
    <nav>
      <button id="btnAll" class="active">Todas Músicas</button>
      <button id="btnPlaylists">Playlists</button>
    </nav>
  </header>

  <div class="container">
    <div id="songsContainer" class="grid"></div>
    <div id="playlistContainer" style="display:none;"></div>
  </div>

  <div class="player">
    <div class="player-info">
      <img id="playerCover" class="player-cover" src="https://via.placeholder.com/50" alt="Capa">
      <div>
        <div id="nowTitle">--</div>
        <div id="nowArtist" style="font-size:14px;color:var(--cinza-claro);">--</div>
      </div>
    </div>
    <div class="controls">
      <button id="prevBtn">⏮️</button>
      <button id="playBtn">▶️</button>
      <button id="nextBtn">⏭️</button>
    </div>
    <audio id="audioPlayer" preload="metadata"></audio>
  </div>

  <script>
    const songsJson = '/music/songs.json';
    let songs = [];
    let currentIndex = 0;

    const songsContainer = document.getElementById('songsContainer');
    const playlistContainer = document.getElementById('playlistContainer');
    const btnAll = document.getElementById('btnAll');
    const btnPlaylists = document.getElementById('btnPlaylists');
    const audio = document.getElementById('audioPlayer');
    const playBtn = document.getElementById('playBtn');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const nowTitle = document.getElementById('nowTitle');
    const nowArtist = document.getElementById('nowArtist');
    const playerCover = document.getElementById('playerCover');

    async function loadSongs() {
      try {
        const res = await fetch(songsJson);
        songs = await res.json();
        renderSongs(songs);
      } catch (e) {
        songsContainer.textContent = 'Erro ao carregar músicas.';
      }
    }

    function renderSongs(list) {
      songsContainer.innerHTML = '';
      list.forEach((s, i) => {
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          <img src="${s.cover}" alt="${s.title}">
          <div class="info">
            <h3>${s.title}</h3>
            <p>${s.artist}</p>
          </div>
        `;
        card.onclick = () => playIndex(i);
        songsContainer.appendChild(card);
      });
    }

    function showPlaylists() {
      songsContainer.style.display = 'none';
      playlistContainer.style.display = 'block';
      playlistContainer.innerHTML = '';
      const fav = songs.filter(s => s.favorite);
      if (fav.length) {
        const title = document.createElement('h3');
        title.textContent = 'Favoritas';
        playlistContainer.appendChild(title);
        fav.forEach(s => {
          const div = document.createElement('div');
          div.className = 'playlist-item';
          div.textContent = `${s.title} — ${s.artist}`;
          div.onclick = () => playSong(s);
          playlistContainer.appendChild(div);
        });
      } else {
        playlistContainer.textContent = 'Sem músicas em playlists.';
      }
    }

    function playIndex(i) {
      currentIndex = i;
      playSong(songs[i]);
    }

    function playSong(s) {
      audio.src = s.mp3;
      nowTitle.textContent = s.title;
      nowArtist.textContent = s.artist;
      playerCover.src = s.cover;
      audio.play();
      playBtn.textContent = '⏸️';
    }

    btnAll.onclick = () => {
      btnAll.classList.add('active');
      btnPlaylists.classList.remove('active');
      songsContainer.style.display = 'grid';
      playlistContainer.style.display = 'none';
    };
    btnPlaylists.onclick = () => {
      btnPlaylists.classList.add('active');
      btnAll.classList.remove('active');
      showPlaylists();
    };

    playBtn.onclick = () => {
      audio.paused ? audio.play() : audio.pause();
    };
    audio.onplay = () => playBtn.textContent = '⏸️';
    audio.onpause = () => playBtn.textContent = '▶️';
    prevBtn.onclick = () => playIndex((currentIndex - 1 + songs.length) % songs.length);
    nextBtn.onclick = () => playIndex((currentIndex + 1) % songs.length);

    window.onload = loadSongs;
  </script>
</body>
</html>
