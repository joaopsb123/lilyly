<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lilyfy – YouTube MP3</title>
  <style>
    body { margin:0; font-family: sans-serif; background:#111; color:#fff; }
    .search { display:flex; padding:20px; gap:10px; }
    .search input { flex:1; padding:8px; border-radius:4px; border:none; }
    .search button { padding:8px 16px; background:#8a2be2; border:none; color:white; cursor:pointer; }
    .results { padding:20px; display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:20px; }
    .card { background:#222; padding:10px; border-radius:8px; display:flex; flex-direction:column; }
    .card h3 { font-size:16px; margin:10px 0; }
    .card small { color:#aaa; margin-bottom:8px; }
    .card button, .card a { margin-right:6px; background:#8a2be2; border:none; border-radius:4px; padding:6px 8px; color:white; cursor:pointer; text-decoration:none;}
    audio { width:100%; margin-bottom:6px; }
  </style>
</head>
<body>

<div class="search">
  <input type="text" id="q" placeholder="Buscar música no YouTube..." />
  <button onclick="doSearch()">Buscar</button>
</div>

<div class="results" id="results">Digite um termo e clique em buscar.</div>

<script>
  const API_KEY = 'be6d832346msh3bdcbc41a36e31fp1de253jsnfd355f97011f';
  const HOST = 'yt-search-and-download-mp3.p.rapidapi.com';

  async function doSearch() {
    const q = document.getElementById('q').value.trim();
    const resDiv = document.getElementById('results');
    if (!q) return resDiv.textContent = 'Digite um termo.';

    resDiv.innerHTML = 'Carregando...';
    try {
      const resp = await fetch(`https://${HOST}/search/${encodeURIComponent(q)}`, {
        method: 'GET',
        headers: {
          'X-Rapidapi-Key': API_KEY,
          'X-Rapidapi-Host': HOST
        }
      });
      const json = await resp.json();
      const items = Array.isArray(json) ? json : (json.results || []);
      if (!items.length) return resDiv.textContent = 'Nenhum resultado.';

      resDiv.innerHTML = '';
      items.forEach(item => {
        const { title, url: videoUrl, thumbnail, channel, link } = item;
        const card = document.createElement('div');
        card.className = 'card';
        card.innerHTML = `
          ${thumbnail ? `<img src="${thumbnail}" alt="${title}" style="width:100%; border-radius:4px">` : ''}
          <h3>${title}</h3>
          <small>${channel || ''}</small>
          <audio controls src="${link}"></audio>
          <a href="${link}" download>⬇️ Baixar MP3</a>
        `;
        resDiv.appendChild(card);
      });
    } catch (err) {
      console.error(err);
      resDiv.textContent = 'Erro ao buscar. Veja o console.';
    }
  }
</script>

</body>
</html>
